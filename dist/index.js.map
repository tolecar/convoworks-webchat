{"version":3,"file":"index.js","sources":["../src/components/messages/Message.jsx","../src/components/messages/MessageGroup.jsx","../src/assets/icons/IconSend.jsx","../src/components/ConvoChat.jsx","../src/index.js"],"sourcesContent":["import React from 'react'\nimport { useState, useEffect } from 'react'\n\nfunction Message(props) {\n\tconst [visible, setVisible] = useState(false);\n\n\t//Finds y value of given object\n\tfunction findPos(obj) {\n\t\tvar curtop = 0;\n\t\tif (obj.offsetParent) {\n\t\t\tdo {\n\t\t\t\tcurtop += obj.offsetTop;\n\t\t\t} while ((obj = obj.offsetParent));\n\t\t\treturn [curtop];\n\t\t}\n\t}\n\n\t// scroll to bottom of the chatbox when a message is sent\n\tfunction handleScroll() {\n\t\tprops.scrollArea.current.scroll(0, findPos(props.scrollAnchor.current));\n\t}\n\n\tuseEffect(() => {\n\t\tif (props.timeout) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsetVisible(true);\n\t\t\t}, [props.timeout])\n\t\t} else {\n\t\t\tsetVisible(true)\n\t\t}\n\t}, [props]);\n\n\tuseEffect(() => {\n\t\thandleScroll();\n\t}, [visible])\n\n\tif (visible) {\n\t\treturn (\n\t\t\t<div className={props.type === 'response' ? 'message message--response' : 'message message--user'}>\n\t\t\t\t<div className=\"message__inner\">{props.text}</div>\n\t\t\t</div>\n\t\t)\n\t} else {\n\t\treturn null\n\t}\n}\n\nexport default Message\n","import React, { useEffect } from 'react'\nimport Message from './Message'\n\nfunction MessageGroup(props) {\n  const handleResponses = (items) => {\n    return items.map((item, index) => {\n      return <Message type={'response'} text={item} key={index} timeout={600} scrollArea={props.scrollArea} scrollAnchor={props.scrollAnchor} />\n    })\n  }\n\n  return (\n    <React.Fragment>\n      <Message type={''} text={props.text} scrollArea={props.scrollArea} scrollAnchor={props.scrollAnchor} />\n      {handleResponses(props.text_responses)}\n    </React.Fragment>\n  )\n}\n\nexport default MessageGroup\n","import React from 'react'\n\nfunction IconSend() {\n\treturn (\n\t\t<div className=\"icon\">\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-send\"><line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\"></line><polygon points=\"22 2 15 22 11 13 2 9 22 2\"></polygon></svg>\n\t\t</div>\n\t)\n}\n\nexport default IconSend\n","import React from \"react\";\nimport \"./convo_chat.scss\";\nimport { useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport MessageGroup from \"./messages/MessageGroup\";\nimport IconSend from \"../assets/icons/IconSend\";\nimport { useEffect } from \"react\";\n\nconst ConvoChat = (props) => {\n\t//State params\n\tconst [message, setMessage] = useState(\"\");\n\tconst [messageGroups, setMessageGroups] = useState([]);\n\tconst [chatVisible, setChatVisible] = useState(true);\n\tconst [deviceId, setDeviceId] = useState(null);\n\n\t// Props \n\tconst serviceId = props.serviceId;\n\tconst variant = props.variant;\n\tconst isLaunch = props.isLaunch;\n\n\t//Refs\n\tconst mainInput = useRef(null);\n\tconst scrollArea = useRef(null);\n\tconst scrollAnchor = useRef(null);\n\n\t//Api Routes\n\tconst convoPublicApiBaseUrl = `http://localhost:9090/rest_public/convo/v1`;\n\n\tuseEffect(() => {\n\t\tsetDeviceId('device');\n\t}, [])\n\n\t// handle message submit \n\tfunction sendMessage(text) {\n\t\tif (!variant) {\n\t\t\tvariant = \"develop\";\n\t\t}\n\n\t\t// request variables\n\t\tconst url = convoPublicApiBaseUrl + \"/service-run/webchat/\" + variant + \"/\" + serviceId;\n\t\tconst data = { device_id: deviceId, text: text, lunch: isLaunch };\n\n\t\t// post request \n\t\taxios({ method: \"post\", url: url, data: data })\n\t\t\t.then((res) => {\n\t\t\t\tsetMessageGroups([\n\t\t\t\t\t...messageGroups,\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: message,\n\t\t\t\t\t\ttext_responses: res.data.text_responses,\n\t\t\t\t\t},\n\t\t\t\t]);\n\t\t\t\tsetMessage(null);\n\t\t\t\tmainInput.current.value = \"\";\n\t\t\t})\n\t\t\t.catch((err) => console.log(err));\n\t}\n\n\treturn (\n\t\t<div className=\"convo-chat\">\n\t\t\t<header\n\t\t\t\tclass=\"convo-chat__header\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\tsetChatVisible(!chatVisible);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tChat\n\t\t\t</header>\n\t\t\t{chatVisible && (\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t<div className=\"convo-chat__body\" ref={scrollArea}>\n\t\t\t\t\t\t{messageGroups.map((item, index) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<MessageGroup\n\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\ttext={item.text}\n\t\t\t\t\t\t\t\t\ttext_responses={item.text_responses}\n\t\t\t\t\t\t\t\t\tscrollArea={scrollArea}\n\t\t\t\t\t\t\t\t\tscrollAnchor={scrollAnchor}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"convo-chat__anchor\"\n\t\t\t\t\t\t\tref={scrollAnchor}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<form\n\t\t\t\t\t\tclassName=\"convo-chat__form\"\n\t\t\t\t\t\tonSubmit={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tmessage &&\n\t\t\t\t\t\t\t\tsendMessage(\n\t\t\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tref={mainInput}\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tdefaultValue={\"\"}\n\t\t\t\t\t\t\tplaceholder=\"Type a message\"\n\t\t\t\t\t\t\tonChange={(e) => setMessage(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button type=\"submit\">\n\t\t\t\t\t\t\t<IconSend />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</form>\n\t\t\t\t</React.Fragment>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default ConvoChat;\n","import React from 'react'\nimport ConvoChat from './components/ConvoChat'\n//import styles from './styles.module.css'\n\nexport const ConvoChatComponent = (props) => {\n\treturn <ConvoChat serviceId={props.serviceId} variant={props.variant} isLaunch={props.isLaunch} />\n}\n"],"names":["Message","props","useState","visible","setVisible","findPos","obj","curtop","offsetParent","offsetTop","handleScroll","scrollArea","current","scroll","scrollAnchor","useEffect","timeout","setTimeout","React","type","text","MessageGroup","handleResponses","items","map","item","index","text_responses","IconSend","ConvoChat","message","setMessage","messageGroups","setMessageGroups","chatVisible","setChatVisible","deviceId","setDeviceId","serviceId","variant","isLaunch","mainInput","useRef","convoPublicApiBaseUrl","sendMessage","url","data","device_id","lunch","axios","method","then","res","value","err","console","log","e","preventDefault","target","ConvoChatComponent"],"mappings":"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"}